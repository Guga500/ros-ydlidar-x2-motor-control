<!-- navigation.launch (fixed) -->
<launch>
  <!-- 1) แผนที่ -->
  <arg name="map_yaml"   default="$(find my_robot)/maps/my_map.yaml"/>  <!-- ★ ใส่ไฟล์จริง -->
  <arg name="base_frame" default="base_footprint"/>
  <arg name="scan_topic" default="/scan"/>

  <node pkg="map_server" type="map_server" name="map_server" args="$(arg map_yaml)"/>

  <!-- 2) AMCL -->
  <node pkg="amcl" type="amcl" name="amcl" output="screen">
    <param name="odom_frame_id"   value="odom"/>
    <param name="base_frame_id"   value="$(arg base_frame)"/>
    <param name="global_frame_id" value="map"/>
    <remap from="scan" to="$(arg scan_topic)"/>   <!-- ★ AMCL อ่านจาก /scan -->
    <rosparam file="$(find my_robot)/config/amcl.yaml" command="load"/>
  </node>

  <!-- 3) move_base -->
  <node pkg="move_base" type="move_base" name="move_base" output="screen" clear_params="true">
    <!-- ความถี่/รีคัฟเวอรี ฯลฯ -->
    <rosparam file="$(find my_robot)/config/move_base.yaml" command="load"/>

    <!-- costmap_common โหลดเข้า namespace ของแต่ละ costmap -->
    <rosparam file="$(find my_robot)/config/costmap_common.yaml" command="load" ns="global_costmap"/>
    <rosparam file="$(find my_robot)/config/costmap_common.yaml" command="load" ns="local_costmap"/>

    <rosparam file="$(find my_robot)/config/global_costmap.yaml" command="load"/>
    <rosparam file="$(find my_robot)/config/local_costmap.yaml"  command="load"/>

    <!-- DWA -->
    <rosparam file="$(find my_robot)/config/dwa_local_planner.yaml" command="load"/>

    <!-- remap อื่น ๆ ตามปกติ -->
    <remap from="odom"    to="/odom"/>
    <remap from="cmd_vel" to="/cmd_vel"/>
    <!-- อย่าตั้ง remap scan ที่นี่ ถ้าใน costmap ตั้ง topic เป็น /scan อยู่แล้ว -->
  </node>
</launch>
